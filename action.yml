name: 'run-on-container'
description: 'Run on container'
inputs:
  run:
    description: Command
    required: true
  image:
    description: Container image
    required: true
  platform:
    description: Platform
    required: false
    default: 'linux/amd64'
  shell:
    description: Shell
    required: false
    default: 'sh'    
runs:
  using: "composite"
  steps:
    - run: |
        tmpfile=$(mktemp)
        echo 'cd /work' > $tmpfile
        echo ${{ inputs.run }} >> $tmpfile
        docker run -v ${{ github.workspace }}:/work -v $tmpfile:/__run.sh -w /work --platform ${{ inputs.platform }} ${{ inputs.image }} ${{ inputs.shell }} /___run.sh
        rm ${{ github.workspace }}/___run.sh
      shell: bash
